import{r as u,g as T,u as $,D as L,z as S,e as A,j as e,C as _,F as o,B as E,L as C,i as I}from"./index-867af749.js";import{V as H,a as F}from"./index.esm-c7bfbe9a.js";import{A as z}from"./index-5b65079c.js";const D="_passwordControllerContainer_qfiyh_1",G="_showPasswordContainer_qfiyh_5",U="_input_qfiyh_12",V="_loginButton_qfiyh_19",Z="_loginContainer_qfiyh_23",R="_cardLogin_qfiyh_26",J="_loginCard_qfiyh_30",M="_CardBody_qfiyh_30",O="_loginTitle_qfiyh_33",Y="_loginSubTitle_qfiyh_43",K="_loglink_qfiyh_60",Q="_pageHeight_qfiyh_69",W="_blueBorder_qfiyh_73",s={passwordControllerContainer:D,showPasswordContainer:G,input:U,loginButton:V,loginContainer:Z,cardLogin:R,loginCard:J,CardBody:M,loginTitle:O,loginSubTitle:Y,loglink:K,pageHeight:Q,blueBorder:W},ne=()=>{var x,f;const[g,m]=u.useState(!1),[t,a]=u.useState({state:!1,message:""}),[l,h]=u.useState({email:"",password:"",userConsent:!1}),{POST:j}=T(),y=$(),w=((f=(x=L().state)==null?void 0:x.from)==null?void 0:f.pathname)||"/",d=S({mutationFn:n=>j("/app/login",n)}),{setAccessToken:N,setAuthUser:q,setProfilePic:b}=A(),k=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,p=n=>{t.state&&a({state:!1,message:""}),h(r=>({...r,[n.target.name]:n.target.value}))},v=n=>{n.preventDefault();const{email:r,password:B,userConsent:P}=l;if(!r||!B)return a({state:!0,message:"Email and password are required."});if(!k.test(r))return a({state:!0,message:"Invalid email format."});if(!P)return a({state:!0,message:"User consent is required to login"});d.mutate(l,{onSuccess:c=>{const i=c.data;q({...i.user,referral_code:i.referral_code,qr_code:i.qr_code}),N(i.accessToken),b(i.profile_pic),y(w,{replace:!0})},onError:c=>{console.log(c),a({state:!0,message:c.message})}})};return e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsxs("div",{className:`container ${s.loginContainer}`,children:[e.jsx(_,{className:`bg-light  ${s.loginCard}`,children:e.jsxs(_.Body,{className:`${s.CardBody}`,children:[e.jsx("h2",{className:`${s.loginTitle}`,children:"Login"}),e.jsx("p",{className:`${s.loginSubTitle}`,children:"Access Your Profile"}),t.state&&e.jsx("p",{className:"text-danger text-center m-0",children:t.message}),e.jsxs(o,{autoComplete:"off",onSubmit:v,className:"mt-5 ",children:[e.jsx(o.Group,{children:e.jsx(o.Control,{placeholder:"Email ID",name:"email",onChange:p,className:`${s.input}  ${t.state?"border-danger":""}`,isInvalid:t.state,type:"email",required:!0})}),e.jsx(o.Group,{className:"mt-4 pt-3",children:e.jsxs("div",{className:s.passwordControllerContainer,children:[e.jsx(o.Control,{name:"password",placeholder:"Password",onChange:p,type:g?"text":"password",className:` ${s.input}   ${t.state?"border-danger":""}`,isInvalid:t.state,required:!0}),!t.state&&e.jsx("span",{className:s.showPasswordContainer,children:g?e.jsx(H,{onClick:()=>m(!1)}):e.jsx(F,{onClick:()=>m(!0)})})]})}),e.jsx(o.Group,{children:e.jsx(o.Check,{id:"user_concent",name:"userConsent",value:l.userConsent,feedbackType:"invalid",isInvalid:!l.userConsent&&t.state,label:"By accepting you allow to store cookies on your device and disclose information in accordance with our Cookie Policy.",onChange:n=>{t.state&&a({state:!1,message:""}),h(r=>({...r,userConsent:n.target.checked}))}})}),e.jsx(o.Group,{className:"mt-4 d-flex pt-3 justify-content-center",children:e.jsxs(E,{type:"submit",className:`golden-button ${s.loginButton}`,disabled:d.isPending,children:[d.isPending?"Loading..":"Login"," "]})})]}),e.jsx("div",{className:"mt-5 d-flex flex-column",children:e.jsx(C,{className:"text-decoration-none text-dark text-center md-text",to:"/forgetpassword",children:e.jsx("strong",{children:"Forgotten Password?"})})})]})}),e.jsx("div",{className:`${s.loglink}`,children:e.jsx(C,{to:"/signup",className:"text-decoration-none",children:e.jsxs("h3",{className:"text-center text-dark header-text",children:["New here? ",e.jsx("strong",{children:"Join the Community"})]})})})]}),e.jsx(I,{})]})};export{ne as default};
